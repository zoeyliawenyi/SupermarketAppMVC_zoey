{
  "info": {
    "name": "ZozoMart - App Flow",
    "_postman_id": "640a26dd-fb85-4f5b-954a-1f8fc6d7ea8a",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Authorization",
      "item": [
        {
          "name": "Login (User)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "email",
                  "value": "user@example.com",
                  "type": "text"
                },
                {
                  "key": "password",
                  "value": "user123",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200 or 302', function () { pm.expect([200,302]).to.include(pm.response.code); });",
                  "const cookie = pm.response.headers.get('set-cookie');",
                  "if (cookie) { pm.environment.set('userCookie', cookie.split(';')[0]); }"
                ]
              }
            }
          ]
        },
        {
          "name": "Login (Admin)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "email",
                  "value": "admin@zozomart.com",
                  "type": "text"
                },
                {
                  "key": "password",
                  "value": "admin123",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200 or 302', function () { pm.expect([200,302]).to.include(pm.response.code); });",
                  "const cookie = pm.response.headers.get('set-cookie');",
                  "if (cookie) { pm.environment.set('adminCookie', cookie.split(';')[0]); }"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Authorization - Negative",
      "item": [
        {
          "name": "PayPal Create Order (Guest)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/paypal/create-order",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 401', function () { pm.expect(pm.response.code).to.equal(401); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin Orders (Non-admin)",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/admin/orders",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 403', function () { pm.expect(pm.response.code).to.equal(403); });"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Cart",
      "item": [
        {
          "name": "Get Cart",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/cart",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Add To Cart",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/add-to-cart/{{productId}}",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "quantity",
                  "value": "1",
                  "type": "text"
                },
                {
                  "key": "buy",
                  "value": "1",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200 or 302', function () { pm.expect([200,302]).to.include(pm.response.code); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Cart Quantity",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/cart/update/{{productId}}",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "quantity",
                  "value": "2",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const json = pm.response.json();",
                  "pm.test('response has success', function () { pm.expect(json.success).to.equal(true); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Delete From Cart",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/cart/delete/{{productId}}",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": []
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Select Items For Checkout",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/cart/select",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "ids",
                  "value": "{{productId}}",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Checkout",
      "item": [
        {
          "name": "Update Shipping Details",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/checkout/shipping",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "contact",
                  "value": "99999999",
                  "type": "text"
                },
                {
                  "key": "address",
                  "value": "123 Test Street",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Shipping Option",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/checkout/option",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "option",
                  "value": "pickup",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Payment Method",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/checkout/payment",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "payment",
                  "value": "paypal",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Place Order (Blocked - requires payment)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/place-order",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "paymentMethod",
                  "value": "nets-qr",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 400', function () { pm.expect(pm.response.code).to.equal(400); });",
                  "const json = pm.response.json();",
                  "pm.test('blocked message', function () { pm.expect(json.success).to.equal(false); });"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Orders",
      "item": [
        {
          "name": "List Orders",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/orders",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Order Detail",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/orders/{{orderId}}",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "pm.test('body has order id', function () { pm.expect(pm.response.text()).to.include('ORDER #'); });",
                  "const codeMatch = pm.response.text().match(/Pickup Code:\\s*([^<\n]+)/i); if (codeMatch && codeMatch[1]) { pm.environment.set('pickupCode', codeMatch[1].trim()); }",
                  "pm.test('payment status present', function () { pm.expect(pm.response.text()).to.match(/payment successful|payment pending|payment failed/i); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Order Invoice (PDF)",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/orders/{{orderId}}/invoice",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200 or 403', function () { pm.expect([200,403]).to.include(pm.response.code); });"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Payments - PayPal (App)",
      "item": [
        {
          "name": "PayPal Create Order (App)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/paypal/create-order",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const json = pm.response.json();",
                  "if (json.orderId) pm.environment.set('orderId', json.orderId);",
                  "if (json.paypalOrderId) pm.environment.set('paypalOrderId', json.paypalOrderId);",
                  "if (json.approveUrl) pm.environment.set('paypalApproveUrl', json.approveUrl);"
                ]
              }
            }
          ]
        },
        {
          "name": "PayPal Capture Order (App)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/paypal/capture-order",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"orderID\": \"{{paypalOrderId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const json = pm.response.json();",
                  "if (json.orderId) pm.environment.set('orderId', json.orderId);",
                  "pm.test('capture success', function () { pm.expect(json.success).to.equal(true); });"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Payments - Stripe (App)",
      "item": [
        {
          "name": "Stripe Create PaymentIntent (App)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/payments/stripe/create-intent",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const json = pm.response.json();",
                  "if (json.orderId) pm.environment.set('orderId', json.orderId);",
                  "if (json.paymentIntentId) pm.environment.set('stripePaymentIntentId', json.paymentIntentId);",
                  "pm.test('clientSecret present', function () { pm.expect(json.clientSecret).to.be.ok; });"
                ]
              }
            }
          ]
        },
        {
          "name": "Stripe Confirm Payment (App)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/payments/stripe/confirm",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"paymentIntentId\": \"{{stripePaymentIntentId}}\",\n  \"orderId\": \"{{orderId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200 or 400', function () { pm.expect([200,400]).to.include(pm.response.code); });",
                  "const json = pm.response.json();",
                  "if (json.orderId) pm.environment.set('orderId', json.orderId);"
                ]
              }
            }
          ]
        },
        {
          "name": "Stripe Dev Confirm (App)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/dev/stripe/intent/succeed",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"paymentIntentId\": \"{{stripePaymentIntentId}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const json = pm.response.json();",
                  "if (json.orderId) pm.environment.set('orderId', json.orderId);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Payments - NETS QR (App)",
      "item": [
        {
          "name": "NETS QR Request (App)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/nets-qr/request",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const match = pm.response.text().match(/Transaction ref:\\s*<strong>([^<]+)<\\/strong>/i);",
                  "if (match && match[1]) { pm.environment.set('netsTxnRef', match[1]); }"
                ]
              }
            }
          ]
        },
        {
          "name": "NETS Simulate Success",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/nets-qr/success?txn_retrieval_ref={{netsTxnRef}}",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 302 or 200', function () { pm.expect([200,302]).to.include(pm.response.code); });",
                  "const loc = pm.response.headers.get('location');",
                  "if (loc) { const m = loc.match(/id=(\\d+)/); if (m) pm.environment.set('orderId', m[1]); }"
                ]
              }
            }
          ]
        },
        {
          "name": "NETS Dev Txn (Debug)",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/dev/nets/tx/{{orderId}}",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const json = pm.response.json();",
                  "if (json.txn && json.txn.txnRetrievalRef) pm.environment.set('netsTxnRef', json.txn.txnRetrievalRef);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Invoices",
      "item": [
        {
          "name": "Invoice (Admin)",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/admin/orders/{{orderId}}/invoice",
            "header": [
              {
                "key": "Cookie",
                "value": "{{adminCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200 or 403', function () { pm.expect([200,403]).to.include(pm.response.code); });"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Refunds",
      "item": [
        {
          "name": "Cancel Order (User)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/orders/{{orderId}}/cancel",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200 or 302', function () { pm.expect([200,302]).to.include(pm.response.code); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Refund Request (User API)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/refunds/request",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"orderId\": \"{{orderId}}\",\n  \"refundType\": \"full_refund\",\n  \"reason\": \"changed_mind\",\n  \"note\": \"Postman refund request\",\n  \"preferredMethod\": \"original\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const json = pm.response.json();",
                  "if (json.refundId) pm.environment.set('refundId', json.refundId);"
                ]
              }
            }
          ]
        },
        {
          "name": "Refund Detail (User API)",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/refunds/{{refundId}}",
            "header": [
              {
                "key": "Cookie",
                "value": "{{userCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin Refund Detail (API)",
          "request": {
            "method": "GET",
            "url": "{{baseUrl}}/api/admin/refunds/{{refundId}}",
            "header": [
              {
                "key": "Cookie",
                "value": "{{adminCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const json = pm.response.json();",
                  "if (json.items && json.items.length) {",
                  "  pm.environment.set('refundItemId', json.items[0].id);",
                  "  pm.environment.set('refundItemQty', json.items[0].qtyRequested);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin Refund Decision (Approve)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/admin/refunds/{{refundId}}/decision",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{adminCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "decision",
                  "value": "approved",
                  "type": "text"
                },
                {
                  "key": "adminNote",
                  "value": "Approved in Postman",
                  "type": "text"
                },
                {
                  "key": "inventoryDisposition",
                  "value": "restock",
                  "type": "text"
                },
                {
                  "key": "qtyApproved_{{refundItemId}}",
                  "value": "{{refundItemQty}}",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin Refund Initiate (API)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/admin/refunds/{{refundId}}/initiate",
            "header": [
              {
                "key": "Cookie",
                "value": "{{adminCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin Refund Complete (API)",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/api/admin/refunds/{{refundId}}/complete",
            "header": [
              {
                "key": "Cookie",
                "value": "{{adminCookie}}",
                "type": "text"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Pickup",
      "item": [
        {
          "name": "Admin Set Ready For Pickup",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/admin/orders/{{orderId}}/status",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{adminCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "status",
                  "value": "ready for pickup",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin Redeem Pickup Code",
          "request": {
            "method": "POST",
            "url": "{{baseUrl}}/admin/pickup/redeem",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/x-www-form-urlencoded"
              },
              {
                "key": "Cookie",
                "value": "{{adminCookie}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "orderId",
                  "value": "{{orderId}}",
                  "type": "text"
                },
                {
                  "key": "pickupCode",
                  "value": "{{pickupCode}}",
                  "type": "text"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('status is 200', function () { pm.expect(pm.response.code).to.equal(200); });",
                  "const json = pm.response.json();",
                  "pm.test('redeemed', function () { pm.expect(json.success).to.equal(true); });"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}
